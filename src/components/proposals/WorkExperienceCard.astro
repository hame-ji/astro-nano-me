---
import type { AstroComponentFactory } from "astro/runtime/server/index.js";

interface Props {
  logo?: string;
  company: string;
  role: string;
  dateLabel: string;
  companyVariant?: "meta" | "chip";
  summary: string;
  Content: AstroComponentFactory;
}

const {
  logo,
  company,
  role,
  dateLabel,
  companyVariant = "meta",
  summary,
  Content,
} = Astro.props;

const logoSrc = logo ? `${import.meta.env.BASE_URL}${logo}` : undefined;
---

<div
  class="relative overflow-hidden rounded-2xl border border-black/[0.03] bg-transparent px-7 py-6 shadow-[0_6px_18px_rgba(15,23,42,0.04)] backdrop-blur-md supports-[backdrop-filter]:bg-black/[0.012] dark:border-white/[0.08] dark:shadow-[0_4px_18px_rgba(2,6,23,0.24)] dark:supports-[backdrop-filter]:bg-white/[0.02]"
>
  <div
    class="pointer-events-none absolute inset-0 bg-gradient-to-b from-white/[0.03] via-transparent to-transparent dark:from-white/[0.06] dark:via-transparent"
  >
  </div>
  <div
    class="pointer-events-none absolute inset-0 dark:hidden"
    style="background: linear-gradient(115deg, transparent 18%, rgba(255,255,255,0.18) 48%, transparent 78%);"
  >
  </div>
  <div
    class="pointer-events-none absolute inset-0 hidden dark:block dark:opacity-20 dark:mix-blend-soft-light"
    style="background-image: radial-gradient(rgba(15,23,42,0.2) 0.6px, transparent 0.6px); background-size: 4px 4px;"
  >
  </div>
  <div
    class="flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between sm:gap-6"
  >
    <div class="min-w-0">
      <div class="flex items-center gap-2 min-w-0">
        {
          logoSrc && (
            <img
              src={logoSrc}
              alt={`Logo ${company}`}
              class="h-5 w-5 shrink-0 object-contain rounded-sm"
              loading="lazy"
              decoding="async"
            />
          )
        }
        <h3
          class="text-lg font-semibold text-black/95 dark:text-white/90 leading-tight"
        >
          {role}
        </h3>
      </div>
      {
        companyVariant === "chip" && (
          <div class="mt-2 inline-flex rounded-full border border-black/8 bg-black/[0.02] px-2 py-0.5 text-sm text-black/45 dark:border-white/12 dark:bg-white/[0.03] dark:text-white/45">
            {company}
          </div>
        )
      }
    </div>
    {
      companyVariant === "meta" ? (
        <div class="font-sans text-xs tracking-wide text-black/45 dark:text-white/45 sm:shrink-0 sm:whitespace-nowrap sm:text-right sm:pt-1">
          {company} â€” {dateLabel}
        </div>
      ) : (
        <div class="font-sans text-xs tracking-wide text-black/45 dark:text-white/45 sm:shrink-0 sm:whitespace-nowrap sm:text-right sm:pt-1">
          {dateLabel}
        </div>
      )
    }
  </div>

  <div class="mt-4 text-base text-black/64 dark:text-white/66 leading-relaxed">
    {summary}
  </div>

  <div class="mt-5 border-t border-black/8 dark:border-white/10"></div>
  <article
    class="mt-5 text-base prose-p:text-black/64 prose-li:text-black/64 prose-headings:text-black/84 prose-headings:font-semibold prose-headings:mt-8 prose-p:leading-relaxed prose-li:leading-relaxed dark:prose-p:text-white/66 dark:prose-li:text-white/66 dark:prose-headings:text-white/85"
  >
    <Content />
  </article>
</div>
